<!DOCTYPE html>
<html lang="en-US">

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" media="screen" href="/kinhnghiemlaptrinh/assets/css/style.css?v=9db0f9cf8eca30a58d4a30265c1a8fb75200028c">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Segment Tree | Kinh nghiệm lập trình</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Segment Tree" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/kinhnghiemlaptrinh/segment_tree/" />
<meta property="og:url" content="http://localhost:4000/kinhnghiemlaptrinh/segment_tree/" />
<meta property="og:site_name" content="Kinh nghiệm lập trình" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Segment Tree" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"Segment Tree","url":"http://localhost:4000/kinhnghiemlaptrinh/segment_tree/"}</script>
<!-- End Jekyll SEO tag -->

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/kinhnghiemlaptrinh/favicon.ico" -->

<!-- end custom head snippets -->

  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          
            <a id="forkme_banner" href="https://github.com/ppap-1264589/kinhnghiemlaptrinh">View on GitHub</a>
          

          <h1 id="project_title">Kinh nghiệm lập trình</h1>
          <h2 id="project_tagline"></h2>

          
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1 id="bài-toán">Bài toán</h1>

<p>Cho $n$ hình chữ nhật trên mặt phẳng tọa độ, tính phần diện tích bị phủ bởi chính xác 2 hình chữ nhật. Mọi phần diện tích bị phủ bởi 1, hoặc 3, hoặc 4,… đều không được tính vào kết quả</p>

<h1 id="input">Input</h1>

<p>Dòng đầu tiên nhập số n</p>

<p>Từ dòng thứ hai trở đi, mỗi dòng nhập 4 số: x1, y1, x2, y2. Lần lượt thể hiện tọa độ góc trái dưới và phải trên của hình chữ nhật</p>

<h1 id="output">Output</h1>

<p>Một dòng duy nhất là phần diện tích bị phủ bởi chính xác 2 hình chữ nhật</p>

<h1 id="giới-hạn">Giới hạn:</h1>

<p>1 &lt;= n &lt;= 10^5</p>

<p>-10^9 &lt;= x1 &lt; x2 &lt;= 10^9</p>

<p>-10^9 &lt;= y1 &lt; y2 &lt;= 10^9</p>

<h1 id="test-ví-dụ">Test ví dụ</h1>

<h2 id="input-1">Input</h2>
<pre><code class="language-C++">3
1 3 4 5
3 1 7 4
5 3 8 6
</code></pre>

<h2 id="output-1">Output</h2>
<pre><code class="language-C++">3
</code></pre>

<h1 id="minh-họa">Minh họa</h1>

<p><img src="/kinhnghiemlaptrinh/segment_tree/TestDeBai.png" alt="Minh họa" /></p>

<h1 id="lời-giải">Lời giải</h1>

<p>Có sự đóng góp lời giải cho hàm push_up() đến từ ChatGPT</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp">
#define up(i,a,b) for (int i = (int)a; i &lt;= (int)b; i++)
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">maxn</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">MOD</span> <span class="o">=</span> <span class="mf">1e9</span> <span class="o">+</span> <span class="mi">7</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">EVENT</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">y1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">y2</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">type</span><span class="p">;</span>
<span class="p">};</span>
<span class="c1">//Các sự kiện sweepline gồm tọa độ x, độ dài y1, y2, và kiểu sự kiện</span>
<span class="c1">//đóng hay mở một đoạn thẳng</span>

<span class="kt">bool</span> <span class="n">comp</span><span class="p">(</span><span class="n">EVENT</span><span class="o">&amp;</span> <span class="n">A</span><span class="p">,</span> <span class="n">EVENT</span><span class="o">&amp;</span> <span class="n">B</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">B</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="k">return</span> <span class="n">A</span><span class="p">.</span><span class="n">type</span> <span class="o">&gt;</span> <span class="n">B</span><span class="p">.</span><span class="n">type</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">B</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">//Xử lý các sự kiện x trước</span>

<span class="n">vector</span><span class="o">&lt;</span><span class="n">EVENT</span><span class="o">&gt;</span> <span class="n">events</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">tempY</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">treesize</span><span class="p">;</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="n">T1</span><span class="p">[</span><span class="n">maxn</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">];</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="n">T2</span><span class="p">[</span><span class="n">maxn</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">];</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="n">T3</span><span class="p">[</span><span class="n">maxn</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">delta</span><span class="p">[</span><span class="n">maxn</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">];</span>
<span class="c1">//treesize thể hiện kích thước thực sự của cây sau khi bị nén</span>
<span class="c1">//maxn &lt;&lt; 1 cho số lượng sự kiện tối đa có thể xảy ra (1 mở và 1 đóng)</span>
<span class="c1">//maxn &lt;&lt; 3 cho ước lượng segment tree trên toàn sự kiện</span>
<span class="c1">//T1 thể hiện segment tree quản lý diện tích bị phủ bởi ít nhất 1 đoạn thẳng</span>
<span class="c1">//T2: bị phủ bởi &gt;= 2 đoạn thẳng</span>
<span class="c1">//T3: bị phủ bởi &gt;= 3 đoạn thẳng</span>


<span class="kt">void</span> <span class="n">push_up</span><span class="p">(</span><span class="kt">int</span> <span class="n">nod</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">tempY</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tempY</span><span class="p">[</span><span class="n">l</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">//      đoạn này bị phủ &gt;=3 lần =&gt; toàn bộ là T3</span>
        <span class="n">T3</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">){</span>
        <span class="c1">// Xử lý riêng các trường hợp nút lá</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>        <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">len</span><span class="p">,</span> <span class="n">T3</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>   <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">len</span><span class="p">,</span> <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T3</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>   <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T3</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">){</span>
        <span class="c1">// whole interval has +2; so &gt;=1 and &gt;=2 are full length</span>
        <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
        <span class="c1">// &gt;=3 are positions where child had &gt;=1</span>
        <span class="n">T3</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">delta</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
        <span class="c1">// whole interval has +1 =&gt; &gt;=1 is full length</span>
        <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">len</span><span class="p">;</span>
        <span class="c1">// &gt;=2 are positions where child had &gt;=1</span>
        <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
        <span class="c1">// &gt;=3 are positions where child had &gt;=2</span>
        <span class="n">T3</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// delta == 0</span>
    <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">T1</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">T2</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">T3</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">=</span> <span class="n">T3</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">T3</span><span class="p">[</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>
<span class="c1">//Nếu "khoảng" [l, r] bị bao hoàn toàn thì lấy toàn bộ</span>
<span class="c1">//Nếu "khoảng" [l, r] chỉ bị bao một phần và không phải nút lá thì cập nhật dựa theo con</span>
<span class="c1">//Nếu "khoảng" lá không bị bao thì phải bằng 0</span>
<span class="c1">//Chú ý: nếu không có điều kiện (l != r) thì segment tree có thể lấy T[nod*2] với nod*2 là chỉ số tràn ngoài phạm vi đã khai báo</span>

<span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="kt">int</span> <span class="n">nod</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">,</span> <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">,</span> <span class="kt">int</span> <span class="n">val</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">u</span> <span class="o">||</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">&gt;=</span> <span class="n">u</span> <span class="o">&amp;&amp;</span> <span class="n">r</span> <span class="o">&lt;=</span> <span class="n">v</span><span class="p">){</span>
        <span class="n">delta</span><span class="p">[</span><span class="n">nod</span><span class="p">]</span> <span class="o">+=</span> <span class="n">val</span><span class="p">;</span>
        <span class="n">push_up</span><span class="p">(</span><span class="n">nod</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">update</span><span class="p">(</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
    <span class="n">update</span><span class="p">(</span><span class="n">nod</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
    <span class="n">push_up</span><span class="p">(</span><span class="n">nod</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">signed</span> <span class="n">main</span><span class="p">(){</span>
    <span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="cp">#define Task "A"
</span>    <span class="k">if</span> <span class="p">(</span><span class="n">fopen</span><span class="p">(</span><span class="n">Task</span><span class="s">".inp"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)){</span>
        <span class="n">freopen</span><span class="p">(</span><span class="n">Task</span><span class="s">".inp"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
        <span class="n">freopen</span><span class="p">(</span><span class="n">Task</span><span class="s">".out"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">,</span> <span class="n">stdout</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">up</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">;</span>
        <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">x1</span> <span class="o">&gt;&gt;</span> <span class="n">y1</span> <span class="o">&gt;&gt;</span> <span class="n">x2</span> <span class="o">&gt;&gt;</span> <span class="n">y2</span><span class="p">;</span>
        <span class="n">tempY</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">y1</span><span class="p">);</span>
        <span class="n">tempY</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">y2</span><span class="p">);</span>
        <span class="n">events</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="mi">1</span><span class="p">});</span>
        <span class="n">events</span><span class="p">.</span><span class="n">push_back</span><span class="p">({</span><span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="n">tempY</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="o">-</span><span class="n">MOD</span><span class="p">);</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">tempY</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">tempY</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
    <span class="n">tempY</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">tempY</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">tempY</span><span class="p">.</span><span class="n">end</span><span class="p">())</span> <span class="o">-</span> <span class="n">tempY</span><span class="p">.</span><span class="n">begin</span><span class="p">());</span>
    <span class="n">treesize</span> <span class="o">=</span> <span class="n">tempY</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="c1">//    tempY thêm phần tử -MOD để lấy lowerbound với chỉ số bắt đầu từ 1</span>
<span class="c1">//    treesize = tempY.size()-1 vì phải bỏ qua phần tử -MOD;</span>


    <span class="n">sort</span><span class="p">(</span><span class="n">events</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">events</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">comp</span><span class="p">);</span>

    <span class="kt">long</span> <span class="kt">long</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">events</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">lower_bound</span><span class="p">(</span><span class="n">tempY</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">tempY</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">events</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y1</span><span class="p">)</span> <span class="o">-</span> <span class="n">tempY</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
        <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">lower_bound</span><span class="p">(</span><span class="n">tempY</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">tempY</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">events</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y2</span><span class="p">)</span> <span class="o">-</span> <span class="n">tempY</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>


        <span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">treesize</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">events</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">type</span><span class="p">);</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="mi">1ll</span> <span class="o">*</span> <span class="p">(</span><span class="n">T2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">T3</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="n">events</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">-</span> <span class="n">events</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="p">);</span>
<span class="c1">//        Segment tree quản lý các "khoảng" giữa tọa độ điểm này và tọa độ điểm kia</span>
<span class="c1">//        có treesize tọa độ điểm thì có treesize-1 "khoảng"</span>
<span class="c1">//        Tại mỗi nút chỉ số v quản lý khoảng [l, r], lấy kết quả nút nếu bị bao toàn bộ là tempY[r+1] - tempY[l]</span>
<span class="c1">//        Do đó, mỗi lần lấy kết quả trong tọa độ [u, v] thì lấy kết quả trên "khoảng" [u, v-1] trên segment tree</span>

<span class="c1">//        cout &lt;&lt; T1[1] &lt;&lt; " " &lt;&lt; T2[1] &lt;&lt; " " &lt;&lt; T3[1] &lt;&lt; " " &lt;&lt; res &lt;&lt; " ";</span>
<span class="c1">//        cout &lt;&lt; u &lt;&lt; " " &lt;&lt; v &lt;&lt; "\n";</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>






<span class="c1">//#include &lt;bits/stdc++.h&gt;</span>
<span class="c1">//#define up(i,a,b) for (int i = (int)a; i &lt;= (int)b; i++)</span>
<span class="c1">//#define down(i,a,b) for (int i = (int)a; i &gt;= (int)b; i--)</span>
<span class="c1">//using namespace std;</span>
<span class="c1">//</span>
<span class="c1">//const int maxn = 5e2 + 10;</span>
<span class="c1">//int n;</span>
<span class="c1">//int a[maxn][maxn];</span>
<span class="c1">//int MAXX = 500;</span>
<span class="c1">//int MAXY = 500;</span>
<span class="c1">//</span>
<span class="c1">//signed main(){//code trau</span>
<span class="c1">//    ios_base::sync_with_stdio(false);</span>
<span class="c1">//    cin.tie(0);</span>
<span class="c1">//    #define Task "A"</span>
<span class="c1">//    if (fopen(Task".inp", "r")){</span>
<span class="c1">//        freopen(Task".inp", "r", stdin);</span>
<span class="c1">//        freopen(Task".out", "w", stdout);</span>
<span class="c1">//    }</span>
<span class="c1">//</span>
<span class="c1">//    int maxx, maxy;</span>
<span class="c1">//    maxx = -MAXX;</span>
<span class="c1">//    maxy = -MAXX;</span>
<span class="c1">//    cin &gt;&gt; n;</span>
<span class="c1">//    up(i,1,n){</span>
<span class="c1">//        int x1, y1, x2, y2;</span>
<span class="c1">//        cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;</span>
<span class="c1">//        maxx = max(maxx, x2-1);</span>
<span class="c1">//        maxy = max(maxy, y2-1);</span>
<span class="c1">//        up(i, x1, x2-1){</span>
<span class="c1">//            up(j, y1, y2-1){</span>
<span class="c1">//                ++a[i][j];</span>
<span class="c1">//            }</span>
<span class="c1">//        }</span>
<span class="c1">//    }</span>
<span class="c1">//</span>
<span class="c1">//    int cnt = 0;</span>
<span class="c1">//    up(i,1,maxx){</span>
<span class="c1">//        up(j,1,maxy){</span>
<span class="c1">//            if (a[i][j] == 2) ++cnt;</span>
<span class="c1">//        }</span>
<span class="c1">//    }</span>
<span class="c1">//    cout &lt;&lt; cnt &lt;&lt; "\n";</span>
<span class="c1">//</span>
<span class="c1">//</span>
<span class="c1">//    down(j,maxy,1){</span>
<span class="c1">//        up(i,1,maxx){</span>
<span class="c1">//            cout &lt;&lt; a[i][j] &lt;&lt; " ";</span>
<span class="c1">//        }</span>
<span class="c1">//        cout &lt;&lt; "\n";</span>
<span class="c1">//    }</span>
<span class="c1">//}</span>
</code></pre></div></div>
<p><a href="../">Quay lại trang chủ</a></p>

      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        
        <p class="copyright">Kinh nghiệm lập trình maintained by <a href="https://github.com/ppap-1264589">ppap-1264589</a></p>
        
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>
  </body>
</html>
